# I/O and Redirection

- 리눅스는 각 명령어가 가능한 작고 간단한 동작만 수행하도록 설계됨
- 따라서 다양한 명령어를 조합해서 사용할 수 있어야 함.
- 리다이렉션과 파이프라인으로 명령어를 조합할 수 있음.

## 표준 입출력

- 명령어 간에 실행 결과를 주고 받는 원리를 이해하기 위해 표준 입출력을 알아야 할 필요가 있음.
- 표준 입출력 채널은 명령어 실행 시 열리며, 데이터가 흐르는 길이라고 볼 수 있음.

### 표준 입출력의 구성

- 표준 입력(stdin): 프로그램에 데이터를 입력하는 채널. 키보드를 통합 입력 등.
- 표준 출력(stdout): 프로그램의 실행 결과가 출력되는 채널. 기본값은 단말 디스플레이.
- 표준 에러 출력(stderr): 프로그램 실행 중 발생하는 에러 메세지가 출력되는 채널. 기본값은 단말 디스플레이.
- 명령어가 실제 표준 입출력 기기를 신경쓰지는 않음.
- 실제 명령어에 연결되는 표준 입출력은 사용자가 셸에서 명령어 실행 시 지정할 수 있음.

## 리다이렉션

- 리다이렉션: 표준 입출력을 어디로 연결할지를 변경하는 것.
- 표준 입력의 리다이렉션 : ‘<’ 기호를 이용

```bash
$ cat < /etc/crontab <- '/etc/crontab' 파일을 입력으로 변경하는 리다이렉션. cat 명령어에 의해 파일 내용이 화면에 출력됨.
```

- 표준 출력의 리다이렉션 : ‘>’ 기호를 이용

```bash
$ ls -l / > list.txt <- 명령어 실행 결과를 list.txt에 리다이렉션
```

- 표준 에러 출력: 프로그램의 에러 메시지를 출력하기 위해 사용됨. 표준 출력을 파일에 리다이렉션해도 에러 메시지는 출력됨.
- 표준 에러 출력을 파일에 리다이렉션하려면 ‘2>’ 기호를 사용

```bash
$ ls /xxxx 2> error.txt <- 에러 메시지를 파일에 저장 
```

- 표준 출력과 표준 에러 출력을 함께 리다이렉션: ‘2>&1’ 기호를 추가
    - 표준입력 = 0
    - 표준출력 = 1
    - 표준 에러 출력 = 2

```bash
$ ls /xxxx 2> result.txt 2>&1
```

- 리다이렉션으로 파일 덮어쓰기
    - 이미 존재하는 파일에 표준 출력을 리다이렉션하면 기존 파일을 지우고 덮어씀
    - 이를 방지하려면 ‘>’ 대신 ‘>>’ 사용 ⇒ 덮어쓰지 않고 파일의 끝에 이어서 쓰게 됨.
    - 또는 noclobber 값을 셸 옵션으로 지정

```bash
$ echo 123 > number.txt
$ cat number.txt
$ echo 456 > number.txt.   <- 동일 파일이름에 리다이렉션해 덮어씀
$ cat number.txt
$ set -o noclobber <- 리다이렉션으로 덮어쓰는 것 방지
```

- /dev/null
    - 특수 파일로 입력 파일로 지정해도 아무 내용이 입력되지 않고, 출력 파일로 지정해도 아무 내용이 기록되지 않음.
    - 때문에 표준 출력으로 출력되는 양이 너무 많거나 표준 에러 출력만 확인할 때 사용

```bash
$ ls / /xxxx > /dev/null
$ ls / /xxxx 2> /dev/null
```

## 파이프라인

- 명령어의 표준 출력을 다른 명령어의 표준 입력으로 연결하는 기능.
- 파이프 기호 (|)를 사용

```bash
$ ls -l / | less <- 파일 리스트를 출력하는 명령어의 출력을 less 명령어로 전달해 출력. 명령어의 실행결과가 방대할 때 상요하는 패턴.
```

- 파이프라인은 기본적으로 표준 출력만 연결
- 표준 에러 출력을 내보내려면 표준 에러 출력과 표준 출력을 동일한 곳으로 리다이렉션해야 함.

```bash
$ ls -l / /xxxx 2>&1 | less
```